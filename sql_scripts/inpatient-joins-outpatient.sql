SELECT inp.DESYNPUF_ID, inp.CLM_FROM_DT AS CLM_FROM_DT_INP, inp.CLM_ID as CLM_ID_INP,inp.CLM_THRU_DT AS CLM_THRU_DT_INP, inp.PRVDR_NUM AS PRVDR_NUM_INP, inp.CLM_PMT_AMT AS CLM_PMT_AMT_INP, inp.NCH_PRMRY_PYR_CLM_PD_AMT AS NCH_PRMRY_PYR_CLM_PD_AMT_INP, inp.AT_PHYSN_NPI AS AT_PHYSN_NPI_INP, inp.OP_PHYSN_NPI AS OP_PHYSN_NPI_INP, inp.CLM_ADMSN_DT AS CLM_ADMSN_DT_INP, inp.CLM_PASS_THRU_PER_DIEM_AMT AS CLM_PASS_THRU_PER_DIEM_AMT_INP, inp.NCH_BENE_IP_DDCTBL_AMT AS NCH_BENE_IP_DDCTBL_AMT_INP, inp.NCH_BENE_PTA_COINSRNC_LBLTY_AM AS NCH_BENE_PTA_COINSRNC_LBLTY_AM_INP, inp.NCH_BENE_BLOOD_DDCTBL_LBLTY_AM AS NCH_BENE_BLOOD_DDCTBL_LBLTY_AM_INP, inp.CLM_UTLZTN_DAY_CNT AS CLM_UTLZTN_DAY_CNT_INP, inp.NCH_BENE_DSCHRG_DT AS NCH_BENE_DSCHRG_DT_INP, inp.CLM_DRG_CD AS CLM_DRG_CD_INP, inp.PRVDR_NUM_CAT AS PRVDR_NUM_CAT_INP, inp.Next_CLM_ADMSN_DT AS Next_CLM_ADMSN_DT_INP, 
inp.Readmission_within_30days AS Readmission_within_30days_INP, inp.CLAIM_YEAR AS CLAIM_YEAR_INP, inp.ADMTNG_ICD9_DGNS_CD_CAT AS ADMTNG_ICD9_DGNS_CD_CAT_INP, inp.ICD9_DGNS_CD_1_CAT AS ICD9_DGNS_CD_1_CAT_INP, inp.ICD9_DGNS_CD_2_CAT AS ICD9_DGNS_CD_2_CAT_INP, inp.ICD9_DGNS_CD_3_CAT AS ICD9_DGNS_CD_3_CAT_INP, inp.ICD9_DGNS_CD_4_CAT AS ICD9_DGNS_CD_4_CAT_INP, 
inp.ICD9_DGNS_CD_5_CAT AS ICD9_DGNS_CD_5_CAT_INP, inp.ICD9_DGNS_CD_6_CAT AS ICD9_DGNS_CD_6_CAT_INP, inp.ICD9_DGNS_CD_7_CAT AS ICD9_DGNS_CD_7_CAT_INP, inp.ICD9_DGNS_CD_8_CAT AS ICD9_DGNS_CD_8_CAT_INP, inp.ICD9_DGNS_CD_9_CAT AS ICD9_DGNS_CD_9_CAT_INP, inp.ICD9_PRCDR_CD_1_CAT AS ICD9_PRCDR_CD_1_CAT_INP,
COUNT(out.CLM_ID) as CLM_ID_OUT 
-- out.CLM_FROM_DT as CLM_FROM_DT_OUT, out.CLM_THRU_DT as CLM_THRU_DT_OUT, out.PRVDR_NUM as PRVDR_NUM_OUT, out.CLM_PMT_AMT as CLM_PMT_AMT_OUT, 
-- out.NCH_PRMRY_PYR_CLM_PD_AMT as NCH_PRMRY_PYR_CLM_PD_AMT_OUT, out.AT_PHYSN_NPI as AT_PHYSN_NPI_OUT, out.NCH_BENE_BLOOD_DDCTBL_LBLTY_AM as NCH_BENE_BLOOD_DDCTBL_LBLTY_AM_OUT, 
-- out.ICD9_DGNS_CD_1 as ICD9_DGNS_CD_1_OUT, out.ICD9_DGNS_CD_2 as ICD9_DGNS_CD_2_OUT, out.NCH_BENE_PTB_DDCTBL_AMT as NCH_BENE_PTB_DDCTBL_AMT_OUT, 
-- out.NCH_BENE_PTB_COINSRNC_AMT as NCH_BENE_PTB_COINSRNC_AMT_OUT, out.HCPCS_CD_1 as HCPCS_CD_1_OUT, out.HCPCS_CD_2 as HCPCS_CD_2_OUT, out.HCPCS_CD_3 as HCPCS_CD_3_OUT, out.PRVDR_NUM_CAT as PRVDR_NUM_CAT_OUT, OUT.ICD9_DGNS_CD_1_CAT AS ICD9_DGNS_CD_1_CAT_OUT,OUT.ICD9_DGNS_CD_2_CAT AS ICD9_DGNS_CD_2_CAT_OUT,OUT.HCPCS_CD_1_CAT AS HCPCS_CD_1_CAT_OUT, OUT.HCPCS_CD_2_CAT AS HCPCS_CD_2_CAT_OUT,
-- OUT.HCPCS_CD_3_CAT AS HCPCS_CD_3_CAT_OUT, OUT.HCPCS_CD_1_CAT_DESC AS HCPCS_CD_1_CAT_DESC_OUT, OUT.HCPCS_CD_2_CAT_DESC AS HCPCS_CD_2_CAT_DESC_OUT, OUT.HCPCS_CD_3_CAT_DESC AS HCPCS_CD_3_CAT_DESC_OUT
FROM Inpatient_claims_2 inp LEFT JOIN Outpatient_claims_2 out 
on inp.DESYNPUF_ID = out.DESYNPUF_ID 
WHERE inp.NCH_BENE_DSCHRG_DT <= out.CLM_FROM_DT AND inp.Next_CLM_ADMSN_DT >= out.CLM_FROM_DT
GROUP BY inp.CLM_ID;